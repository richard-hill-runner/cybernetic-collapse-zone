this is some work I hope to PR into the upstream master
